import{y as b,r as i,z as V,o as A,a as c,b as n,f as t,B as h,F,g as I,t as u,w as C,e as S,m as E,v as _,C as T,n as U}from"./index-IzLOKglm.js";import{B as $,a as L}from"./BaseError-DNv4Myx8.js";/* empty css                                                                  */async function O(){const r=await b("/structures");return Array.isArray(r)?r:[]}async function z(r){return await b("/structures",{method:"POST",body:JSON.stringify(r)})}async function J(r,m){return await b(`/structures/${r}`,{method:"PUT",body:JSON.stringify(m)})}async function P(r){return await b(`/structures/${r}`,{method:"DELETE"}),!0}const j={class:"content-area"},q={key:2,class:"table-wrap"},G={class:"data-table"},H=["onClick"],K=["onClick"],Q={class:"modal-dialog"},R={class:"modal-content"},W={class:"modal-header"},X={class:"modal-body"},Y={class:"form-grid"},Z={class:"form-group form-group-large"},tt={class:"form-group form-group-large"},et={class:"form-group"},at={key:0,style:{color:"#dc3545"}},ot={key:1,style:{color:"#198754"}},nt={__name:"EstruturasView",setup(r){const m=i([]),w=i(!1),f=i(""),y=i(!1),v=i(null),o=V({nome:"",descricao:"",ativo:!0}),l=i(""),d=i("");function k(){o.nome="",o.descricao="",o.ativo=!0,v.value=null,l.value="",d.value=""}function N(){k(),y.value=!0}function x(a){v.value=a.id,o.nome=a.nome||a.name||"",o.descricao=a.descricao||a.description||"",o.ativo=a.ativo!==!1,l.value="",d.value="",y.value=!0}function p(){y.value=!1}async function g(){w.value=!0,f.value="";try{m.value=await O()}catch(a){f.value=(a==null?void 0:a.message)||"Erro ao carregar estruturas"}finally{w.value=!1}}async function B(){if(l.value="",d.value="",!o.nome){l.value="Nome é obrigatório.";return}const a={nome:o.nome,descricao:o.descricao,ativo:!!o.ativo};try{v.value?await J(v.value,a):await z(a),d.value="Estrutura salva.",p(),k(),await g()}catch(e){l.value=(e==null?void 0:e.message)||"Erro ao salvar"}}async function D(a){if(confirm("Confirma excluir a estrutura #"+a.id+"?"))try{await P(a.id),await g()}catch(e){l.value=(e==null?void 0:e.message)||"Erro ao excluir"}}return A(async()=>{await g()}),(a,e)=>(n(),c("section",j,[t("div",{class:"page-header",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},[e[3]||(e[3]=t("h2",{style:{margin:"0"}},"Estruturas",-1)),t("div",{class:"page-actions",style:{display:"flex",gap:".5rem"}},[t("button",{class:"btn btn-primary",onClick:N},"Nova Estrutura")])]),f.value?(n(),h($,{key:0,message:f.value,retry:g},null,8,["message"])):w.value?(n(),h(L,{key:1,message:"Carregando estruturas…"})):(n(),c("div",q,[t("table",G,[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Nome"),t("th",null,"Descrição"),t("th",null,"Status"),t("th",null,"Ações")])],-1)),t("tbody",null,[(n(!0),c(F,null,I(m.value,s=>(n(),c("tr",{key:s.id},[t("td",null,u(s.id),1),t("td",null,u(s.nome||s.name),1),t("td",null,u(s.descricao||s.description||"-"),1),t("td",null,u(s.ativo!==!1?"Ativo":"Inativo"),1),t("td",null,[t("button",{class:"btn-icon btn-warning",onClick:M=>x(s),title:"Editar"},[...e[4]||(e[4]=[t("i",{class:"fa-solid fa-pen"},null,-1)])],8,H),t("button",{class:"btn-icon btn-danger",onClick:M=>D(s),title:"Excluir"},[...e[5]||(e[5]=[t("i",{class:"fa-solid fa-trash"},null,-1)])],8,K)])]))),128))])])])),t("div",{class:U(["modal",{show:y.value}]),role:"dialog","aria-hidden":"true",onClick:C(p,["self"])},[t("div",Q,[t("div",R,[t("div",W,[t("h3",null,u(v.value?"Editar Estrutura":"Nova Estrutura"),1),t("button",{type:"button",class:"btn-close",onClick:p,"aria-label":"Fechar"},[...e[7]||(e[7]=[t("i",{class:"fa-solid fa-times"},null,-1)])])]),t("form",{onSubmit:C(B,["prevent"])},[t("div",X,[t("div",Y,[t("div",Z,[e[8]||(e[8]=t("label",{for:"nome"},"Nome",-1)),E(t("input",{id:"nome",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=s=>o.nome=s),required:""},null,512),[[_,o.nome,void 0,{trim:!0}]])]),t("div",tt,[e[9]||(e[9]=t("label",{for:"descricao"},"Descrição",-1)),E(t("textarea",{id:"descricao",class:"form-control",rows:"3","onUpdate:modelValue":e[1]||(e[1]=s=>o.descricao=s)},null,512),[[_,o.descricao,void 0,{trim:!0}]])]),t("div",et,[e[11]||(e[11]=t("label",{for:"ativo"},"Status",-1)),E(t("select",{id:"ativo",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>o.ativo=s)},[...e[10]||(e[10]=[t("option",{value:!0},"Ativo",-1),t("option",{value:!1},"Inativo",-1)])],512),[[T,o.ativo]])])]),l.value?(n(),c("div",at,u(l.value),1)):S("",!0),d.value?(n(),c("div",ot,u(d.value),1)):S("",!0)]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary",onClick:p},"Cancelar"),e[12]||(e[12]=t("button",{type:"submit",class:"btn btn-success"},"Salvar",-1))])],32)])])],2)]))}};export{nt as default};
