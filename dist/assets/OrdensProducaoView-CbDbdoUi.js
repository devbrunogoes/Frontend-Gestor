import{y as g,r as c,z as x,o as V,a as m,b as v,f as t,F as A,g as D,t as l,w as C,e as I,m as d,v as f,C as P,n as M}from"./index-IzLOKglm.js";async function U(){const n=await g("/production-orders");return Array.isArray(n)?n:[]}async function _(n){return await g("/production-orders",{method:"POST",body:JSON.stringify(n)})}async function T(n,p){return await g(`/production-orders/${n}`,{method:"PUT",body:JSON.stringify(p)})}async function $(n){return await g(`/production-orders/${n}`,{method:"DELETE"}),!0}const z={class:"content-area"},B={class:"table-wrap"},L={class:"data-table"},Q=["onClick"],j=["onClick"],J={class:"modal-dialog"},G={class:"modal-content"},H={class:"modal-header"},K={class:"modal-body"},R={class:"form-grid"},W={class:"form-group form-group-large"},X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group form-group-large"},tt={class:"form-group"},at={class:"form-group"},ot={key:0,style:{color:"#dc3545"}},et={key:1,style:{color:"#198754"}},nt={__name:"OrdensProducaoView",setup(n){const p=c([]),b=c(!1),u=c(null),o=x({produto:"",quantidade:1,status:"aberta",observacoes:"",dataInicio:"",dataFim:""}),i=c(""),r=c("");function q(e){try{return e?new Date(e).toLocaleString():"-"}catch{return"-"}}function F(){Object.assign(o,{produto:"",quantidade:1,status:"aberta",observacoes:"",dataInicio:"",dataFim:""}),u.value=null,i.value="",r.value=""}function k(){F(),b.value=!0}function S(e){u.value=e.id,o.produto=e.produto||e.product||"",o.quantidade=e.quantidade||e.quantity||1,o.status=e.status||"aberta",o.observacoes=e.observacoes||e.notes||"",o.dataInicio=e.dataInicio||e.startedAt||"",o.dataFim=e.dataFim||e.finishedAt||"",i.value="",r.value="",b.value=!0}function y(){b.value=!1}async function w(){p.value=await U()}function O(e){if(!e)return null;try{const a=new Date(e);return isNaN(a)?e:a.toISOString()}catch{return e}}async function E(){if(i.value="",r.value="",!o.produto){i.value="Produto é obrigatório.";return}if(!o.quantidade||o.quantidade<1){i.value="Quantidade deve ser >= 1.";return}const e={produto:o.produto,quantidade:Number(o.quantidade||1),status:o.status,observacoes:o.observacoes,dataInicio:O(o.dataInicio),dataFim:O(o.dataFim)};try{u.value?await T(u.value,e):await _(e),r.value="Ordem salva.",y(),F(),await w()}catch(a){i.value=(a==null?void 0:a.message)||"Erro ao salvar"}}async function h(e){if(confirm("Confirma excluir a ordem #"+e.id+"?"))try{await $(e.id),await w()}catch(a){i.value=(a==null?void 0:a.message)||"Erro ao excluir"}}return V(async()=>{await w()}),(e,a)=>(v(),m("section",z,[t("div",{class:"page-header",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},[a[6]||(a[6]=t("h2",{style:{margin:"0"}},"Ordens de Produção",-1)),t("div",{class:"page-actions",style:{display:"flex",gap:".5rem"}},[t("button",{class:"btn btn-primary",onClick:k},"Nova Ordem")])]),t("div",B,[t("table",L,[a[9]||(a[9]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Produto"),t("th",null,"Quantidade"),t("th",null,"Status"),t("th",null,"Início"),t("th",null,"Fim"),t("th",null,"Ações")])],-1)),t("tbody",null,[(v(!0),m(A,null,D(p.value,s=>(v(),m("tr",{key:s.id},[t("td",null,l(s.id),1),t("td",null,l(s.produto||s.product),1),t("td",null,l(s.quantidade||s.quantity),1),t("td",null,l(s.status),1),t("td",null,l(q(s.dataInicio||s.startedAt)),1),t("td",null,l(q(s.dataFim||s.finishedAt)),1),t("td",null,[t("button",{class:"btn-icon btn-warning",onClick:N=>S(s),title:"Editar"},[...a[7]||(a[7]=[t("i",{class:"fa-solid fa-pen"},null,-1)])],8,Q),t("button",{class:"btn-icon btn-danger",onClick:N=>h(s),title:"Excluir"},[...a[8]||(a[8]=[t("i",{class:"fa-solid fa-trash"},null,-1)])],8,j)])]))),128))])])]),t("div",{class:M(["modal",{show:b.value}]),role:"dialog","aria-hidden":"true",onClick:C(y,["self"])},[t("div",J,[t("div",G,[t("div",H,[t("h3",null,l(u.value?"Editar Ordem":"Nova Ordem"),1),t("button",{type:"button",class:"btn-close",onClick:y,"aria-label":"Fechar"},[...a[10]||(a[10]=[t("i",{class:"fa-solid fa-times"},null,-1)])])]),t("form",{onSubmit:C(E,["prevent"])},[t("div",K,[t("div",R,[t("div",W,[a[11]||(a[11]=t("label",{for:"produto"},"Produto",-1)),d(t("input",{id:"produto",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=s=>o.produto=s),required:""},null,512),[[f,o.produto,void 0,{trim:!0}]])]),t("div",X,[a[12]||(a[12]=t("label",{for:"quantidade"},"Quantidade",-1)),d(t("input",{id:"quantidade",class:"form-control",type:"number",min:"1","onUpdate:modelValue":a[1]||(a[1]=s=>o.quantidade=s)},null,512),[[f,o.quantidade,void 0,{number:!0}]])]),t("div",Y,[a[14]||(a[14]=t("label",{for:"status"},"Status",-1)),d(t("select",{id:"status",class:"form-control","onUpdate:modelValue":a[2]||(a[2]=s=>o.status=s)},[...a[13]||(a[13]=[t("option",{value:"aberta"},"Aberta",-1),t("option",{value:"em_producao"},"Em Produção",-1),t("option",{value:"concluida"},"Concluída",-1),t("option",{value:"cancelada"},"Cancelada",-1)])],512),[[P,o.status]])]),t("div",Z,[a[15]||(a[15]=t("label",{for:"obs"},"Observações",-1)),d(t("textarea",{id:"obs",class:"form-control",rows:"3","onUpdate:modelValue":a[3]||(a[3]=s=>o.observacoes=s)},null,512),[[f,o.observacoes,void 0,{trim:!0}]])]),t("div",tt,[a[16]||(a[16]=t("label",{for:"inicio"},"Início",-1)),d(t("input",{id:"inicio",class:"form-control",type:"datetime-local","onUpdate:modelValue":a[4]||(a[4]=s=>o.dataInicio=s)},null,512),[[f,o.dataInicio]])]),t("div",at,[a[17]||(a[17]=t("label",{for:"fim"},"Fim",-1)),d(t("input",{id:"fim",class:"form-control",type:"datetime-local","onUpdate:modelValue":a[5]||(a[5]=s=>o.dataFim=s)},null,512),[[f,o.dataFim]])])]),i.value?(v(),m("div",ot,l(i.value),1)):I("",!0),r.value?(v(),m("div",et,l(r.value),1)):I("",!0)]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancelar"),a[18]||(a[18]=t("button",{type:"submit",class:"btn btn-success"},"Salvar",-1))])],32)])])],2)]))}};export{nt as default};
