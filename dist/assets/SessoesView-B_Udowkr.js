import{s as k,r as c,o as S,a as r,b as n,f as e,e as b,z as _,t as l,F as A,g as B}from"./index-CXM7zIvA.js";import{B as C,a as E}from"./BaseError-DaDu2INT.js";/* empty css                                                                  */async function x(){const o=await k("/sessions");return Array.isArray(o)?o:[]}async function I(o){return await k(`/sessions/${o}/terminate`,{method:"POST"}),!0}const D={class:"content-area"},F={key:0,style:{color:"#dc3545","margin-bottom":".5rem"}},L={key:1,style:{color:"#198754","margin-bottom":".5rem"}},M={key:4,class:"table-wrap"},R={class:"data-table"},V=["disabled","onClick"],j={__name:"SessoesView",setup(o){const g=c([]),i=c(""),u=c(""),v=c(!1),d=c("");function y(a){try{return a?new Date(a).toLocaleString():"-"}catch{return"-"}}async function m(){i.value="",u.value="",v.value=!0,d.value="";try{g.value=await x()}catch(a){d.value=(a==null?void 0:a.message)||"Erro ao carregar sessões"}finally{v.value=!1}}async function w(a){if(confirm("Revogar a sessão #"+a.id+"?")){i.value="",u.value="";try{await I(a.id),u.value="Sessão revogada.",await m()}catch(s){i.value=(s==null?void 0:s.message)||"Erro ao revogar"}}}return S(async()=>{await m()}),(a,s)=>(n(),r("section",D,[e("div",{class:"page-header",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},[s[0]||(s[0]=e("h2",{style:{margin:"0"}},"Sessões",-1)),e("div",{class:"page-actions",style:{display:"flex",gap:".5rem"}},[e("button",{class:"btn btn-secondary",onClick:m},"Atualizar")])]),i.value?(n(),r("div",F,l(i.value),1)):b("",!0),u.value?(n(),r("div",L,l(u.value),1)):b("",!0),d.value?(n(),_(C,{key:2,message:d.value,retry:m},null,8,["message"])):v.value?(n(),_(E,{key:3,message:"Carregando sessões…"})):(n(),r("div",M,[e("table",R,[s[1]||(s[1]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Usuário"),e("th",null,"IP"),e("th",null,"Início"),e("th",null,"Último Acesso"),e("th",null,"Status"),e("th",null,"Ações")])],-1)),e("tbody",null,[(n(!0),r(A,null,B(g.value,t=>{var f,p,h;return n(),r("tr",{key:t.id},[e("td",null,l(t.id),1),e("td",null,l(((f=t.user)==null?void 0:f.nome)||((p=t.user)==null?void 0:p.name)||((h=t.user)==null?void 0:h.email)||t.userId||"-"),1),e("td",null,l(t.ip||"-"),1),e("td",null,l(y(t.startedAt||t.start||t.createdAt)),1),e("td",null,l(y(t.lastSeen||t.updatedAt)),1),e("td",null,l(t.active===!1?"Revogada":"Ativa"),1),e("td",null,[e("button",{class:"btn btn-sm btn-danger",disabled:t.active===!1,onClick:z=>w(t)},"Revogar",8,V)])])}),128))])])]))]))}};export{j as default};
