import{r as d,c as j,o as B,a as v,b as o,f as e,B as C,e as E,m as w,v as L,C as _,h as g,t as s,F as N,g as S}from"./index-IzLOKglm.js";import{l as V}from"./clients-DV1jXavO.js";import{B as I,a as R}from"./BaseError-DNv4Myx8.js";/* empty css                                                                  */const T={class:"content-area"},U={class:"page-header",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},A={class:"page-actions",style:{display:"flex",gap:".5rem","flex-wrap":"wrap","align-items":"center"}},D=["disabled"],F=["disabled"],P={key:2,class:"card",style:{"margin-bottom":"1rem",display:"flex",gap:"1rem","flex-wrap":"wrap"}},M={key:3,class:"table-wrap"},J={class:"data-table"},K={__name:"RelatorioClientesView",setup(O){const b=d([]),r=d(!1),u=d(""),p=d(""),m=d(""),i=j(()=>{const a=(p.value||"").toLowerCase();return b.value.filter(t=>m.value==="ativo"&&t.active===!1||m.value==="inativo"&&t.active!==!1?!1:a?[t.nome||t.name||"",t.email||"",t.cpfcnpj||"",t.telefone||"",String(t.id||"")].join(" ").toLowerCase().includes(a):!0)});async function c(){r.value=!0,u.value="";try{b.value=await V()}catch(a){u.value=(a==null?void 0:a.message)||"Erro ao carregar clientes"}finally{r.value=!1}}function h(){const a=["ID","Nome","CPF/CNPJ","Telefone","E-mail","Status"],t=i.value.map(n=>[n.id,n.nome||n.name||"",n.cpfcnpj||"",n.telefone||"",n.email||"",n.active!==!1?"Ativo":"Inativo"]),l=[a.join(","),...t.map(n=>n.map(k=>'"'+String(k).replace(/"/g,'""')+'"').join(","))].join(`
`),x=new Blob([l],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(x),f=document.createElement("a");f.href=y,f.download="relatorio-clientes.csv",f.click(),URL.revokeObjectURL(y)}return B(c),(a,t)=>(o(),v("section",T,[e("div",U,[t[3]||(t[3]=e("h2",{style:{margin:"0"}},"Relatório de Clientes",-1)),e("div",A,[w(e("input",{class:"form-control",style:{"min-width":"260px"},placeholder:"Buscar por nome/email/cpf…","onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l)},null,512),[[L,p.value,void 0,{trim:!0}]]),w(e("select",{class:"form-control","onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l)},[...t[2]||(t[2]=[e("option",{value:""},"Todos",-1),e("option",{value:"ativo"},"Ativos",-1),e("option",{value:"inativo"},"Inativos",-1)])],512),[[_,m.value]]),e("button",{class:"btn btn-secondary",onClick:c,disabled:r.value},"Atualizar",8,D),e("button",{class:"btn btn-outline",onClick:h,disabled:!i.value.length},"Exportar CSV",8,F)])]),u.value?(o(),C(I,{key:0,message:u.value,retry:c},null,8,["message"])):r.value?(o(),C(R,{key:1,message:"Carregando clientes…"})):(o(),v("div",P,[e("div",null,[t[4]||(t[4]=e("strong",null,"Total:",-1)),g(" "+s(i.value.length),1)]),e("div",null,[t[5]||(t[5]=e("strong",null,"Ativos:",-1)),g(" "+s(i.value.filter(l=>l.active!==!1).length),1)]),e("div",null,[t[6]||(t[6]=e("strong",null,"Inativos:",-1)),g(" "+s(i.value.filter(l=>l.active===!1).length),1)])])),!r.value&&!u.value?(o(),v("div",M,[e("table",J,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Nome"),e("th",null,"CPF/CNPJ"),e("th",null,"Telefone"),e("th",null,"E-mail"),e("th",null,"Status")])],-1)),e("tbody",null,[(o(!0),v(N,null,S(i.value,l=>(o(),v("tr",{key:l.id},[e("td",null,s(l.id),1),e("td",null,s(l.nome||l.name),1),e("td",null,s(l.cpfcnpj||"-"),1),e("td",null,s(l.telefone||"-"),1),e("td",null,s(l.email||"-"),1),e("td",null,s(l.active!==!1?"Ativo":"Inativo"),1)]))),128))])])])):E("",!0)]))}};export{K as default};
