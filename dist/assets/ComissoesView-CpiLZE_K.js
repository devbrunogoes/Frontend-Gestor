import{y as C,r as u,z as $,o as I,a as r,b as l,f as o,B as E,F as k,g as P,t as i,w as h,e as N,m as g,v as V,C as _,n as F,h as S}from"./index-IzLOKglm.js";import{B as A,a as L}from"./BaseError-DNv4Myx8.js";/* empty css                                                                  */async function O(){return await C("/commissions")}async function z(d){return await C("/commissions",{method:"POST",body:JSON.stringify(d)})}async function J(d,m){return await C(`/commissions/${d}`,{method:"PUT",body:JSON.stringify(m)})}async function j(d){return await C(`/commissions/${d}`,{method:"DELETE"}),!0}const q={class:"content-area"},R={key:2,class:"table-wrap"},G={class:"data-table"},H={class:"badge badge-info"},K=["onClick"],Q=["onClick"],W={class:"modal-dialog"},X={class:"modal-content"},Y={class:"modal-header"},Z={class:"modal-body"},oo={class:"form-grid"},so={class:"form-group form-group-large"},to={class:"form-group"},ao={class:"form-group"},eo={class:"form-group"},lo={key:0,style:{color:"#dc3545"}},io={key:1,style:{color:"#198754"}},co={__name:"ComissoesView",setup(d){const m=u([]),w=u(!1),p=u(""),f=u(!1),v=u(null),t=$({descricao:"",tipo:"percentual",valor:0,ativo:!0}),n=u(""),c=u("");function x(){t.descricao="",t.tipo="percentual",t.valor=0,t.ativo=!0,v.value=null,n.value="",c.value=""}function B(){x(),f.value=!0}function D(e){v.value=e.id,t.descricao=e.descricao||e.description||"",t.tipo=e.tipo||"percentual",t.valor=Number(e.valor||0),t.ativo=e.ativo!==!1,n.value="",c.value="",f.value=!0}function b(){f.value=!1}async function y(){w.value=!0,p.value="";try{m.value=await O()}catch(e){p.value=(e==null?void 0:e.message)||"Erro ao carregar comissões"}finally{w.value=!1}}async function M(){if(n.value="",c.value="",!t.descricao){n.value="Descrição é obrigatória.";return}const e={descricao:t.descricao,tipo:t.tipo,valor:Number(t.valor||0),ativo:!!t.ativo};try{v.value?await J(v.value,e):await z(e),c.value="Comissão salva.",b(),x(),await y()}catch(s){n.value=(s==null?void 0:s.message)||"Erro ao salvar"}}async function T(e){if(confirm("Confirma excluir a comissão #"+e.id+"?"))try{await j(e.id),await y()}catch(s){n.value=(s==null?void 0:s.message)||"Erro ao excluir"}}return I(async()=>{await y()}),(e,s)=>(l(),r("section",q,[o("div",{class:"page-header",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"1rem"}},[s[4]||(s[4]=o("h2",{style:{margin:"0"}},"Comissões",-1)),o("div",{class:"page-actions",style:{display:"flex",gap:".5rem"}},[o("button",{class:"btn btn-primary",onClick:B},"Nova Comissão")])]),p.value?(l(),E(A,{key:0,message:p.value,retry:y},null,8,["message"])):w.value?(l(),E(L,{key:1,message:"Carregando comissões…"})):(l(),r("div",R,[o("table",G,[s[7]||(s[7]=o("thead",null,[o("tr",null,[o("th",null,"ID"),o("th",null,"Descrição"),o("th",null,"Tipo"),o("th",null,"Valor"),o("th",null,"Status"),o("th",{class:"actions"},"Ações")])],-1)),o("tbody",null,[(l(!0),r(k,null,P(m.value,a=>(l(),r("tr",{key:a.id},[o("td",null,i(a.id),1),o("td",null,i(a.descricao||a.description),1),o("td",null,[o("span",H,i((a.tipo||"percentual")==="percentual"?"Percentual":"Fixo"),1)]),o("td",null,[(a.tipo||"percentual")==="percentual"?(l(),r(k,{key:0},[S(i(Number(a.valor||0).toFixed(2))+"%",1)],64)):(l(),r(k,{key:1},[S("R$ "+i(Number(a.valor||0).toFixed(2)),1)],64))]),o("td",null,[o("span",{class:F(["badge status-badge",a.ativo!==!1?"badge-success":"badge-secondary"])},i(a.ativo!==!1?"Ativo":"Inativo"),3)]),o("td",null,[o("button",{class:"btn-icon btn-warning",onClick:U=>D(a),title:"Editar"},[...s[5]||(s[5]=[o("i",{class:"fa-solid fa-pen"},null,-1)])],8,K),o("button",{class:"btn-icon btn-danger",onClick:U=>T(a),title:"Excluir"},[...s[6]||(s[6]=[o("i",{class:"fa-solid fa-trash"},null,-1)])],8,Q)])]))),128))])])])),o("div",{class:F(["modal",{show:f.value}]),role:"dialog","aria-hidden":"true",onClick:h(b,["self"])},[o("div",W,[o("div",X,[o("div",Y,[o("h3",null,i(v.value?"Editar Comissão":"Nova Comissão"),1),o("button",{type:"button",class:"btn-close",onClick:b,"aria-label":"Fechar"},[...s[8]||(s[8]=[o("i",{class:"fa-solid fa-times"},null,-1)])])]),o("form",{onSubmit:h(M,["prevent"])},[o("div",Z,[o("div",oo,[o("div",so,[s[9]||(s[9]=o("label",{for:"descricao"},"Descrição",-1)),g(o("input",{id:"descricao",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=a=>t.descricao=a),required:""},null,512),[[V,t.descricao,void 0,{trim:!0}]])]),o("div",to,[s[11]||(s[11]=o("label",{for:"tipo"},"Tipo",-1)),g(o("select",{id:"tipo",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>t.tipo=a)},[...s[10]||(s[10]=[o("option",{value:"percentual"},"Percentual",-1),o("option",{value:"fixo"},"Fixo",-1)])],512),[[_,t.tipo]])]),o("div",ao,[s[12]||(s[12]=o("label",{for:"valor"},"Valor",-1)),g(o("input",{id:"valor",class:"form-control",type:"number",step:"0.01","onUpdate:modelValue":s[2]||(s[2]=a=>t.valor=a)},null,512),[[V,t.valor,void 0,{number:!0}]])]),o("div",eo,[s[14]||(s[14]=o("label",{for:"ativo"},"Status",-1)),g(o("select",{id:"ativo",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=a=>t.ativo=a)},[...s[13]||(s[13]=[o("option",{value:!0},"Ativo",-1),o("option",{value:!1},"Inativo",-1)])],512),[[_,t.ativo]])])]),n.value?(l(),r("div",lo,i(n.value),1)):N("",!0),c.value?(l(),r("div",io,i(c.value),1)):N("",!0)]),o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary",onClick:b},"Cancelar"),s[15]||(s[15]=o("button",{type:"submit",class:"btn btn-success"},"Salvar",-1))])],32)])])],2)]))}};export{co as default};
