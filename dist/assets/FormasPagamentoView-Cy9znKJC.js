import{s as B,_ as at,r as d,x as $,c as k,o as et,y as st,a as i,b as l,f as a,d as ot,z,p as lt,e as S,n as m,t as n,T as nt,F as P,j as f,v as A,A as L,g as R,w as O}from"./index-CXM7zIvA.js";import{B as it,a as rt}from"./BaseError-DaDu2INT.js";/* empty css                                                                  */async function ut(){return await B("/payment-methods")}async function dt(v){return await B("/payment-methods",{method:"POST",body:JSON.stringify(v)})}async function ct(v,u){return await B(`/payment-methods/${v}`,{method:"PUT",body:JSON.stringify(u)})}async function mt(v){return await B(`/payment-methods/${v}`,{method:"DELETE"}),!0}const pt={class:"content-area payments-view"},vt={key:0,class:"fa-solid fa-circle-check"},ft={key:1,class:"fa-solid fa-circle-exclamation"},yt={class:"overview-grid","aria-label":"Resumo das formas de pagamento"},gt={class:"metric-card"},bt={class:"metric-value"},kt={class:"metric-card good"},Ct={class:"metric-value"},xt={class:"metric-card accent"},wt={class:"metric-value"},Ft={class:"toolbar"},Tt={class:"search-box"},ht={class:"toolbar-right"},Dt={class:"filter-group",role:"group","aria-label":"Filtro de status"},Bt={class:"type-filter"},Nt=["value"],Mt={key:0,class:"empty-state",role:"alert"},Et={key:1,class:"methods-grid",role:"list"},St={class:"card-header"},Pt={class:"card-title"},At={class:"fee-highlight"},Lt={class:"card-meta"},Vt={class:"card-actions"},_t=["onClick"],It=["onClick"],Ut={class:"modal-dialog"},$t={class:"modal-content"},zt={class:"modal-header"},Rt={class:"modal-body"},Ot={class:"form-grid"},jt={class:"form-group form-group-large",for:"nome"},qt={class:"form-group",for:"tipo"},Jt={class:"form-group",for:"taxa"},Xt={class:"form-group",for:"ativo"},Gt={key:0,class:"alert alert-error"},Ht={__name:"FormasPagamentoView",setup(v){const u=d([]),N=d(!0),C=d(""),x=d(!1),y=d(null),o=$({nome:"",tipo:"Dinheiro",taxa:0,active:!0}),c=d(""),M=d(""),g=d("all"),w=d("all"),r=$({type:"",message:""});let p=null;const j={Dinheiro:"type-cash","Cartão Débito":"type-debit","Cartão Crédito":"type-credit",PIX:"type-pix",Boleto:"type-boleto",Transferência:"type-transfer"},q=k(()=>u.value.length),J=k(()=>u.value.filter(s=>s.active!==!1).length),X=k(()=>{if(!u.value.length)return 0;const s=u.value.map(e=>Math.max(0,F(e.taxa))),t=s.reduce((e,b)=>e+b,0);return s.length?t/s.length:0}),G=k(()=>{const s=new Set;return u.value.forEach(t=>{t.tipo&&s.add(t.tipo)}),Array.from(s).sort((t,e)=>t.localeCompare(e,"pt-BR"))}),V=k(()=>{const s=M.value.trim().toLowerCase();return u.value.filter(t=>{switch(g.value){case"active":return t.active!==!1;case"inactive":return t.active===!1;default:return!0}}).filter(t=>w.value==="all"?!0:(t.tipo||"").toLowerCase()===w.value.toLowerCase()).filter(t=>s?[t.nome,t.tipo].filter(Boolean).join(" ").toLowerCase().includes(s):!0).sort((t,e)=>{const b=(t.nome||"").toLowerCase(),tt=(e.nome||"").toLowerCase();return b.localeCompare(tt,"pt-BR")})});function F(s){const t=Number(s??0);return Number.isFinite(t)?t:0}function _(s){return`${F(s).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}%`}function H(s){if(!s)return"—";const t=new Date(s);return Number.isNaN(t.getTime())?"—":t.toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"})}function K(s){return j[s]||"type-default"}function E(s){g.value=s}function T(s,t){r.type=s,r.message=t,p&&clearTimeout(p),p=setTimeout(()=>{r.type="",r.message=""},3500)}function Q(){p&&clearTimeout(p),r.type="",r.message=""}function I(){o.nome="",o.tipo="Dinheiro",o.taxa=0,o.active=!0,y.value=null,c.value=""}function U(){I(),x.value=!0}function W(s){y.value=s.id,o.nome=s.nome||"",o.tipo=s.tipo||"Dinheiro",o.taxa=F(s.taxa),o.active=s.active!==!1,c.value="",x.value=!0}function h(){x.value=!1}async function D(){N.value=!0,C.value="";try{const s=await ut();u.value=Array.isArray(s)?s:[]}catch(s){C.value=(s==null?void 0:s.message)||"Erro ao carregar formas de pagamento."}finally{N.value=!1}}async function Y(){if(c.value="",!o.nome){c.value="Informe o nome da forma de pagamento.";return}const s=F(o.taxa);if(s<0){c.value="A taxa não pode ser negativa.";return}const t={nome:o.nome,tipo:o.tipo,taxa:s,active:!!o.active};try{y.value?(await ct(y.value,t),T("success","Forma de pagamento atualizada.")):(await dt(t),T("success","Forma de pagamento criada.")),h(),I(),await D()}catch(e){c.value=(e==null?void 0:e.message)||"Erro ao salvar forma de pagamento."}}async function Z(s){if(confirm(`Confirma excluir a forma #${s.id}?`))try{await mt(s.id),T("success","Forma de pagamento excluída."),await D()}catch(t){T("error",(t==null?void 0:t.message)||"Erro ao excluir forma de pagamento.")}}return et(()=>{D()}),st(()=>{p&&clearTimeout(p)}),(s,t)=>(l(),i("section",pt,[a("header",{class:"page-header payments-header"},[t[10]||(t[10]=a("div",{class:"header-copy"},[a("h2",null,"Formas de Pagamento"),a("p",null,"Controle os meios de recebimento e taxas aplicadas em cada transação.")],-1)),a("button",{class:"btn btn-primary header-action",type:"button",onClick:U},[...t[9]||(t[9]=[a("i",{class:"fa-solid fa-plus"},null,-1),a("span",null,"Nova forma",-1)])])]),ot(nt,{name:"fade-slide"},{default:lt(()=>[r.message?(l(),i("div",{key:0,class:m(["feedback-banner",r.type])},[r.type==="success"?(l(),i("i",vt)):r.type==="error"?(l(),i("i",ft)):S("",!0),a("span",null,n(r.message),1),a("button",{type:"button",class:"close-banner",onClick:Q,"aria-label":"Fechar aviso"},[...t[11]||(t[11]=[a("i",{class:"fa-solid fa-xmark"},null,-1)])])],2)):S("",!0)]),_:1}),C.value?(l(),z(it,{key:0,message:C.value,retry:D},null,8,["message"])):N.value?(l(),z(rt,{key:1,message:"Carregando formas de pagamento…"})):(l(),i(P,{key:2},[a("section",yt,[a("article",gt,[t[12]||(t[12]=a("span",{class:"metric-label"},"Total cadastradas",-1)),a("strong",bt,n(q.value),1)]),a("article",kt,[t[13]||(t[13]=a("span",{class:"metric-label"},"Ativas",-1)),a("strong",Ct,n(J.value),1)]),a("article",xt,[t[14]||(t[14]=a("span",{class:"metric-label"},"Taxa média",-1)),a("strong",wt,n(_(X.value)),1)])]),a("div",Ft,[a("div",Tt,[t[15]||(t[15]=a("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),f(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e),type:"search",placeholder:"Buscar por nome ou tipo…","aria-label":"Buscar formas de pagamento"},null,512),[[A,M.value,void 0,{trim:!0}]])]),a("div",ht,[a("div",Dt,[a("button",{type:"button",class:m(["filter-chip",{active:g.value==="all"}]),onClick:t[1]||(t[1]=e=>E("all"))}," Todas ",2),a("button",{type:"button",class:m(["filter-chip",{active:g.value==="active"}]),onClick:t[2]||(t[2]=e=>E("active"))}," Ativas ",2),a("button",{type:"button",class:m(["filter-chip",{active:g.value==="inactive"}]),onClick:t[3]||(t[3]=e=>E("inactive"))}," Inativas ",2)]),a("label",Bt,[t[17]||(t[17]=a("span",null,"Tipo",-1)),f(a("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e)},[t[16]||(t[16]=a("option",{value:"all"},"Todos",-1)),(l(!0),i(P,null,R(G.value,e=>(l(),i("option",{key:e,value:e},n(e),9,Nt))),128))],512),[[L,w.value]])])])]),V.value.length?(l(),i("div",Et,[(l(!0),i(P,null,R(V.value,e=>(l(),i("article",{key:e.id,class:m(["method-card",{inactive:e.active===!1}]),role:"listitem"},[a("header",St,[a("div",Pt,[a("h3",null,n(e.nome),1),a("span",{class:m(["type-pill",K(e.tipo)])},n(e.tipo||"Sem tipo"),3)]),a("span",{class:m(["status-pill",e.active!==!1?"status-active":"status-inactive"])},n(e.active!==!1?"Ativa":"Inativa"),3)]),a("div",At,[t[22]||(t[22]=a("span",null,"Taxa padrão",-1)),a("strong",null,n(_(e.taxa)),1)]),a("dl",Lt,[a("div",null,[t[23]||(t[23]=a("dt",null,"ID interno",-1)),a("dd",null,"#"+n(e.id),1)]),a("div",null,[t[24]||(t[24]=a("dt",null,"Status",-1)),a("dd",null,n(e.active!==!1?"Disponível":"Desabilitada"),1)]),a("div",null,[t[25]||(t[25]=a("dt",null,"Última atualização",-1)),a("dd",null,n(H(e.updatedAt)),1)])]),a("footer",Vt,[a("button",{type:"button",class:"btn btn-light",onClick:b=>W(e)},[...t[26]||(t[26]=[a("i",{class:"fa-solid fa-pen"},null,-1),a("span",null,"Editar",-1)])],8,_t),a("button",{type:"button",class:"btn btn-danger",onClick:b=>Z(e)},[...t[27]||(t[27]=[a("i",{class:"fa-solid fa-trash"},null,-1),a("span",null,"Excluir",-1)])],8,It)])],2))),128))])):(l(),i("div",Mt,[t[19]||(t[19]=a("i",{class:"fa-solid fa-wallet"},null,-1)),t[20]||(t[20]=a("h3",null,"Nenhuma forma encontrada",-1)),t[21]||(t[21]=a("p",null,"Cadastre uma nova forma de pagamento ou ajuste os filtros para visualizar resultados.",-1)),a("button",{class:"btn btn-primary",type:"button",onClick:U},[...t[18]||(t[18]=[a("i",{class:"fa-solid fa-plus"},null,-1),a("span",null,"Adicionar forma",-1)])])]))],64)),a("div",{class:m(["modal",{show:x.value}]),role:"dialog","aria-hidden":"true",onClick:O(h,["self"])},[a("div",Ut,[a("div",$t,[a("div",zt,[a("div",null,[a("h3",null,n(y.value?"Editar forma de pagamento":"Nova forma de pagamento"),1),t[28]||(t[28]=a("p",{class:"modal-subtitle"},"Defina as condições gerais e mantenha taxas sempre atualizadas.",-1))]),a("button",{type:"button",class:"btn-close",onClick:h,"aria-label":"Fechar"},[...t[29]||(t[29]=[a("i",{class:"fa-solid fa-xmark"},null,-1)])])]),a("form",{onSubmit:O(Y,["prevent"])},[a("div",Rt,[a("div",Ot,[a("label",jt,[t[30]||(t[30]=a("span",null,"Nome",-1)),f(a("input",{id:"nome",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>o.nome=e),required:""},null,512),[[A,o.nome,void 0,{trim:!0}]])]),a("label",qt,[t[32]||(t[32]=a("span",null,"Tipo",-1)),f(a("select",{id:"tipo",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>o.tipo=e)},[...t[31]||(t[31]=[a("option",null,"Dinheiro",-1),a("option",null,"Cartão Débito",-1),a("option",null,"Cartão Crédito",-1),a("option",null,"PIX",-1),a("option",null,"Boleto",-1),a("option",null,"Transferência",-1)])],512),[[L,o.tipo]])]),a("label",Jt,[t[33]||(t[33]=a("span",null,"Taxa (%)",-1)),f(a("input",{id:"taxa",type:"number",step:"0.01",min:"0",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=e=>o.taxa=e)},null,512),[[A,o.taxa,void 0,{number:!0}]])]),a("label",Xt,[t[35]||(t[35]=a("span",null,"Status",-1)),f(a("select",{id:"ativo",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=e=>o.active=e)},[...t[34]||(t[34]=[a("option",{value:!0},"Ativa",-1),a("option",{value:!1},"Inativa",-1)])],512),[[L,o.active]])])]),c.value?(l(),i("div",Gt,n(c.value),1)):S("",!0)]),a("div",{class:"modal-footer"},[a("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancelar"),t[36]||(t[36]=a("button",{type:"submit",class:"btn btn-success"},"Salvar forma",-1))])],32)])])],2)]))}},Yt=at(Ht,[["__scopeId","data-v-30a989b2"]]);export{Yt as default};
