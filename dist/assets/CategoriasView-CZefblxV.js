import{y as x,_ as G,r as c,z as I,c as h,o as H,A as K,a as n,b as l,f as a,d as Q,B as $,s as W,e as B,n as m,t as r,T as X,F as D,m as _,v as S,g as Y,w as M,C as Z}from"./index-IzLOKglm.js";import{B as aa,a as ea}from"./BaseError-DNv4Myx8.js";/* empty css                                                                  */async function ta(){return await x("/products/categories")}async function sa(f){return await x("/products/categories",{method:"POST",body:JSON.stringify(f)})}async function oa(f,u){return await x(`/products/categories/${f}`,{method:"PUT",body:JSON.stringify(u)})}async function la(f){return await x(`/products/categories/${f}`,{method:"DELETE"}),!0}const ia={class:"content-area categories-view"},ra={key:0,class:"fa-solid fa-circle-check"},na={key:1,class:"fa-solid fa-circle-exclamation"},ca={class:"overview-grid","aria-label":"Resumo das categorias"},ua={class:"metric-card"},da={class:"metric-value"},va={class:"metric-card good"},ma={class:"metric-value"},fa={class:"metric-card neutral"},pa={class:"metric-value"},ga={class:"toolbar"},ba={class:"search-box"},ya={class:"filter-group",role:"group","aria-label":"Filtro de status"},Ca={key:0,class:"empty-state",role:"alert"},ka={key:1,class:"categories-grid",role:"list"},wa={class:"card-header"},ha={class:"card-description"},_a={class:"card-meta"},xa={class:"card-actions"},Ta=["onClick"],Ea=["onClick"],Fa={class:"modal-dialog"},Ba={class:"modal-content"},Sa={class:"modal-header"},Na={class:"modal-body"},Va={class:"form-grid"},Aa={class:"form-group form-group-large",for:"nome"},Ia={class:"form-group form-group-large",for:"descricao"},$a={class:"form-group",for:"status"},Da={key:0,class:"alert alert-error"},Ma={__name:"CategoriasView",setup(f){const u=c([]),T=c(!1),b=c(""),y=c(!1),p=c(null),o=I({nome:"",descricao:"",active:!0}),d=c(""),E=c(""),g=c("all"),i=I({type:"",message:""});let v=null;const U=h(()=>u.value.length),z=h(()=>u.value.filter(t=>t.active!==!1).length),L=h(()=>u.value.filter(t=>t.active===!1).length),N=h(()=>{const t=E.value.trim().toLowerCase();return u.value.filter(O).filter(e=>t?[e.nome,e.descricao].filter(Boolean).join(" ").toLowerCase().includes(t):!0)});function O(t){switch(g.value){case"active":return t.active!==!1;case"inactive":return t.active===!1;default:return!0}}function F(t){g.value=t}function C(t,e){i.type=t,i.message=e,v&&clearTimeout(v),v=setTimeout(()=>{i.type="",i.message=""},3500)}function j(){v&&clearTimeout(v),i.type="",i.message=""}function V(){o.nome="",o.descricao="",o.active=!0,p.value=null,d.value=""}function A(){V(),y.value=!0}function P(t){p.value=t.id,o.nome=t.nome||"",o.descricao=t.descricao||"",o.active=t.active!==!1,d.value="",y.value=!0}function k(){y.value=!1}async function w(){T.value=!0,b.value="";try{const t=await ta();u.value=Array.isArray(t)?t:[]}catch(t){b.value=(t==null?void 0:t.message)||"Erro ao carregar categorias."}finally{T.value=!1}}async function J(){if(d.value="",!o.nome){d.value="Informe o nome da categoria.";return}const t={nome:o.nome,descricao:o.descricao,active:!!o.active};try{p.value?(await oa(p.value,t),C("success","Categoria atualizada com sucesso.")):(await sa(t),C("success","Categoria criada com sucesso.")),k(),V(),await w()}catch(e){d.value=(e==null?void 0:e.message)||"Erro ao salvar categoria."}}async function R(t){if(confirm(`Confirma excluir a categoria #${t.id}?`))try{await la(t.id),C("success","Categoria excluída."),await w()}catch(e){C("error",(e==null?void 0:e.message)||"Erro ao excluir categoria.")}}return H(()=>{w()}),K(()=>{v&&clearTimeout(v)}),(t,e)=>(l(),n("section",ia,[a("header",{class:"page-header categories-header"},[e[8]||(e[8]=a("div",{class:"header-copy"},[a("h2",null,"Categorias"),a("p",null,"Organize seus produtos por segmentos claros e facilite a gestão diária.")],-1)),a("button",{class:"btn btn-primary header-action",type:"button",onClick:A},[...e[7]||(e[7]=[a("i",{class:"fa-solid fa-plus"},null,-1),a("span",null,"Nova categoria",-1)])])]),Q(X,{name:"fade-slide"},{default:W(()=>[i.message?(l(),n("div",{key:0,class:m(["feedback-banner",i.type])},[i.type==="success"?(l(),n("i",ra)):i.type==="error"?(l(),n("i",na)):B("",!0),a("span",null,r(i.message),1),a("button",{type:"button",class:"close-banner",onClick:j,"aria-label":"Fechar aviso"},[...e[9]||(e[9]=[a("i",{class:"fa-solid fa-xmark"},null,-1)])])],2)):B("",!0)]),_:1}),b.value?(l(),$(aa,{key:0,message:b.value,retry:w},null,8,["message"])):T.value?(l(),$(ea,{key:1,message:"Carregando categorias…"})):(l(),n(D,{key:2},[a("section",ca,[a("article",ua,[e[10]||(e[10]=a("span",{class:"metric-label"},"Total cadastradas",-1)),a("strong",da,r(U.value),1)]),a("article",va,[e[11]||(e[11]=a("span",{class:"metric-label"},"Ativas",-1)),a("strong",ma,r(z.value),1)]),a("article",fa,[e[12]||(e[12]=a("span",{class:"metric-label"},"Inativas",-1)),a("strong",pa,r(L.value),1)])]),a("div",ga,[a("div",ba,[e[13]||(e[13]=a("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),_(a("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>E.value=s),type:"search",placeholder:"Buscar por nome, descrição…","aria-label":"Buscar categorias"},null,512),[[S,E.value,void 0,{trim:!0}]])]),a("div",ya,[a("button",{type:"button",class:m(["filter-chip",{active:g.value==="all"}]),onClick:e[1]||(e[1]=s=>F("all"))}," Todas ",2),a("button",{type:"button",class:m(["filter-chip",{active:g.value==="active"}]),onClick:e[2]||(e[2]=s=>F("active"))}," Ativas ",2),a("button",{type:"button",class:m(["filter-chip",{active:g.value==="inactive"}]),onClick:e[3]||(e[3]=s=>F("inactive"))}," Inativas ",2)])]),N.value.length?(l(),n("div",ka,[(l(!0),n(D,null,Y(N.value,s=>(l(),n("article",{key:s.id,class:m(["category-card",{inactive:s.active===!1}]),role:"listitem"},[a("header",wa,[a("h3",null,r(s.nome),1),a("span",{class:m(["status-pill",s.active!==!1?"status-active":"status-inactive"])},r(s.active!==!1?"Ativa":"Inativa"),3)]),a("p",ha,r(s.descricao||"Sem descrição cadastrada."),1),a("dl",_a,[a("div",null,[e[18]||(e[18]=a("dt",null,"ID interno",-1)),a("dd",null,"#"+r(s.id),1)]),a("div",null,[e[19]||(e[19]=a("dt",null,"Produtos relacionados",-1)),a("dd",null,r(s.productsCount??"—"),1)])]),a("footer",xa,[a("button",{type:"button",class:"btn btn-light",onClick:q=>P(s)},[...e[20]||(e[20]=[a("i",{class:"fa-solid fa-pen"},null,-1),a("span",null,"Editar",-1)])],8,Ta),a("button",{type:"button",class:"btn btn-danger",onClick:q=>R(s)},[...e[21]||(e[21]=[a("i",{class:"fa-solid fa-trash"},null,-1),a("span",null,"Excluir",-1)])],8,Ea)])],2))),128))])):(l(),n("div",Ca,[e[15]||(e[15]=a("i",{class:"fa-solid fa-folder-open"},null,-1)),e[16]||(e[16]=a("h3",null,"Nenhuma categoria encontrada",-1)),e[17]||(e[17]=a("p",null,"Cadastre uma nova categoria ou ajuste a busca para visualizar resultados.",-1)),a("button",{class:"btn btn-primary",type:"button",onClick:A},[...e[14]||(e[14]=[a("i",{class:"fa-solid fa-plus"},null,-1),a("span",null,"Adicionar categoria",-1)])])]))],64)),a("div",{class:m(["modal",{show:y.value}]),role:"dialog","aria-hidden":"true",onClick:M(k,["self"])},[a("div",Fa,[a("div",Ba,[a("div",Sa,[a("div",null,[a("h3",null,r(p.value?"Editar categoria":"Nova categoria"),1),e[22]||(e[22]=a("p",{class:"modal-subtitle"},"Defina um nome objetivo e uma descrição curta para facilitar a busca.",-1))]),a("button",{type:"button",class:"btn-close",onClick:k,"aria-label":"Fechar"},[...e[23]||(e[23]=[a("i",{class:"fa-solid fa-xmark"},null,-1)])])]),a("form",{onSubmit:M(J,["prevent"])},[a("div",Na,[a("div",Va,[a("label",Aa,[e[24]||(e[24]=a("span",null,"Nome",-1)),_(a("input",{id:"nome",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=s=>o.nome=s),required:""},null,512),[[S,o.nome,void 0,{trim:!0}]])]),a("label",Ia,[e[25]||(e[25]=a("span",null,"Descrição",-1)),_(a("textarea",{id:"descricao",class:"form-control",rows:"3","onUpdate:modelValue":e[5]||(e[5]=s=>o.descricao=s),placeholder:"Resumo para identificar a categoria"},null,512),[[S,o.descricao,void 0,{trim:!0}]])]),a("label",$a,[e[27]||(e[27]=a("span",null,"Status",-1)),_(a("select",{id:"status",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=s=>o.active=s)},[...e[26]||(e[26]=[a("option",{value:!0},"Ativa",-1),a("option",{value:!1},"Inativa",-1)])],512),[[Z,o.active]])])]),d.value?(l(),n("div",Da,r(d.value),1)):B("",!0)]),a("div",{class:"modal-footer"},[a("button",{type:"button",class:"btn btn-secondary",onClick:k},"Cancelar"),e[28]||(e[28]=a("button",{type:"submit",class:"btn btn-success"},"Salvar categoria",-1))])],32)])])],2)]))}},Oa=G(Ma,[["__scopeId","data-v-b9a881ed"]]);export{Oa as default};
