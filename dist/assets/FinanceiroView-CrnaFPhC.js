import{_ as ae,r as d,c as u,o as te,a as l,b as n,f as e,t as o,d as N,s as C,h as x,x as oe,m as p,v as m,F as R,g as P,w as A,n as K,e as Q,C as le}from"./index-IzLOKglm.js";/* empty css                                                                  */import{l as ne}from"./sales-5D-YZoeD.js";import{l as ie,c as re}from"./expenses-Dw-_t_jz.js";import{l as de,c as ue}from"./receivables-DjFeXSt8.js";import{g as ce}from"./settings-DMRFxweM.js";const ve={class:"finance-page"},pe={class:"finance-content"},me={class:"finance-header"},fe={class:"header-main"},_e={class:"header-copy"},be={class:"header-summary chip-grid"},ge={class:"summary-card"},ye={class:"summary-value"},he={class:"summary-card warning"},De={class:"summary-value"},we={class:"summary-card accent"},ke={class:"summary-value"},Se={class:"toolbar-actions"},Ve={class:"header-links"},Ne={class:"range-card"},Ce={class:"form-group"},xe={class:"form-group"},Re={class:"panel-grid"},Pe={class:"panel"},Ae={class:"panel-header"},Ue={class:"pill"},Ee={key:0,class:"item-list"},Fe={class:"item-title"},Ie={class:"item-sub"},Be={class:"item-meta"},Le={class:"amount"},Me={class:"tag"},qe={key:1,class:"empty"},Oe={class:"panel"},je={class:"panel-header"},$e={class:"pill warning"},Te={key:0,class:"item-list"},ze={class:"item-title"},He={class:"item-sub"},Ge={class:"item-meta"},Je={class:"amount neg"},Ke={class:"tag"},Qe={key:1,class:"empty"},We={class:"panel"},Xe={class:"panel-header"},Ye={class:"pill accent"},Ze={class:"dual"},es={class:"dual-col"},ss={class:"item-sub"},as={key:0,class:"item-list"},ts={class:"item-title"},os={class:"item-sub"},ls={class:"item-meta"},ns={class:"amount"},is={key:1,class:"empty"},rs={class:"dual-col"},ds={class:"item-sub"},us={key:0,class:"item-list"},cs={class:"item-title"},vs={class:"item-sub"},ps={class:"item-meta"},ms={class:"amount neg"},fs={key:1,class:"empty"},_s={class:"modal-dialog"},bs={class:"modal-content"},gs={class:"modal-body"},ys={class:"form-grid"},hs={class:"form-group"},Ds={class:"form-group"},ws={class:"form-group"},ks={class:"form-group"},Ss={key:0,class:"form-error"},Vs={class:"modal-footer"},Ns=["disabled"],Cs={class:"modal-dialog"},xs={class:"modal-content"},Rs={class:"modal-body"},Ps={class:"form-grid"},As={class:"form-group"},Us={class:"form-group"},Es={class:"form-group"},Fs={class:"form-group"},Is={class:"form-group"},Bs={key:0,class:"form-error"},Ls={class:"modal-footer"},Ms=["disabled"],qs={__name:"FinanceiroView",setup(Os){const h=()=>new Date().toISOString().slice(0,10),b=d({inicio:(a=>{const s=new Date;return s.setDate(s.getDate()-a),s.toISOString().slice(0,10)})(30),fim:h()}),U=d([]),D=d([]),w=d([]),k=d(!1),$=d(""),W=d({receberDiasPadrao:0}),E=d(!1),F=d(!1),I=d(""),B=d(""),c=d({descricao:"",cliente:"",valor:0,vencimento:h()}),i=d({descricao:"",fornecedor:"",valor:0,data:h(),pago:!1}),g=a=>(Number(a)||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),S=a=>{if(!a)return"—";const s=new Date(a);return Number.isNaN(s.getTime())?"—":s.toLocaleDateString("pt-BR")},v=a=>{const s=new Date(a);return Number.isNaN(s.getTime())?"":s.toISOString().slice(0,10)},f=a=>{if(!a)return!1;const s=v(a);return s>=b.value.inicio&&s<=b.value.fim},L=u(()=>U.value.filter(a=>(a.paymentStatus||"").toLowerCase()==="pago"&&f(a.date||a.data||a.createdAt)).reduce((a,s)=>a+Number(s.total||0),0)),X=u(()=>U.value.filter(a=>(a.paymentStatus||"").toLowerCase()!=="pago"&&f(a.date||a.data||a.createdAt)).reduce((a,s)=>a+Number(s.total||0),0)),M=u(()=>D.value.filter(a=>!!a.pago&&f(a.data)).reduce((a,s)=>a+Number(s.valor||0),0)),T=u(()=>D.value.filter(a=>!a.pago&&f(a.data)).reduce((a,s)=>a+Number(s.valor||0),0)),z=u(()=>w.value.filter(a=>!a.pago&&f(a.vencimento||a.data||a.dueDate)).reduce((a,s)=>a+Number(s.valor||s.value||0),0));u(()=>L.value-M.value);const Y=u(()=>L.value+z.value-(M.value+T.value)),Z=u(()=>L.value+X.value+z.value),q=u(()=>M.value+T.value),H=u(()=>q.value?Y.value/q.value:0),O=u(()=>w.value.filter(a=>!a.pago&&!J(a.vencimento||a.dueDate)&&f(a.vencimento||a.dueDate||a.data)).sort((a,s)=>v(a.vencimento||a.dueDate)>v(s.vencimento||s.dueDate)?1:-1)),j=u(()=>D.value.filter(a=>!a.pago&&!J(a.data||a.vencimento||a.dueDate)&&f(a.data||a.vencimento||a.dueDate)).sort((a,s)=>v(a.data||a.vencimento||a.dueDate)>v(s.data||s.vencimento||s.dueDate)?1:-1)),_=u(()=>{const a=h(),s=w.value.filter(t=>!t.pago&&v(t.vencimento||t.dueDate)&&v(t.vencimento||t.dueDate)<a),r=D.value.filter(t=>!t.pago&&v(t.data||t.vencimento||t.dueDate)&&v(t.data||t.vencimento||t.dueDate)<a);return{receitas:s,despesas:r,total:s.length+r.length}});function G(a){const s=v(a);if(!s)return"—";const r=Math.ceil((new Date(s)-new Date)/(1e3*60*60*24));return r<0?`${Math.abs(r)}d em atraso`:r===0?"Hoje":`Em ${r}d`}function J(a){const s=v(a);return s&&s<h()}async function V(){k.value=!0,$.value="";try{const[a,s,r]=await Promise.all([ne(),ie(),de()]);U.value=a||[],D.value=s||[],w.value=r||[]}catch(a){$.value=(a==null?void 0:a.message)||"Erro ao carregar dados financeiros."}finally{k.value=!1}}function y(){E.value=!1,F.value=!1}async function ee(){try{await ue({descricao:c.value.descricao,cliente:c.value.cliente,valor:c.value.valor,vencimento:c.value.vencimento,pago:!1}),E.value=!1,await V()}catch(a){I.value=(a==null?void 0:a.message)||"Erro ao salvar receita."}}async function se(){try{await re({descricao:i.value.descricao,fornecedor:i.value.fornecedor,valor:i.value.valor,data:i.value.data,pago:i.value.pago}),F.value=!1,await V()}catch(a){B.value=(a==null?void 0:a.message)||"Erro ao salvar despesa."}}return te(async()=>{W.value=await ce().catch(()=>({receberDiasPadrao:0})),await V()}),(a,s)=>{const r=oe("router-link");return n(),l("section",ve,[e("section",pe,[e("header",me,[e("div",fe,[e("div",_e,[s[14]||(s[14]=e("p",{class:"eyebrow"},"Painel financeiro",-1)),s[15]||(s[15]=e("h1",null,"Financeiro",-1)),s[16]||(s[16]=e("p",{class:"lede"},"Panorama consolidado de receitas, despesas e projecoes do caixa.",-1)),e("div",be,[e("div",ge,[s[11]||(s[11]=e("span",{class:"summary-label"},"Receitas prev.",-1)),e("strong",ye,o(g(Z.value)),1)]),e("div",he,[s[12]||(s[12]=e("span",{class:"summary-label"},"Despesas prev.",-1)),e("strong",De,o(g(q.value)),1)]),e("div",we,[s[13]||(s[13]=e("span",{class:"summary-label"},"Cobertura caixa",-1)),e("strong",ke,o(H.value<=0?"N/A":`${H.value.toFixed(1)}x`),1)])])])]),e("div",Se,[e("div",Ve,[N(r,{to:"/contas-pagar",class:"btn btn-ghost"},{default:C(()=>[...s[17]||(s[17]=[x("Contas a pagar",-1)])]),_:1}),N(r,{to:"/contas-receber",class:"btn btn-ghost"},{default:C(()=>[...s[18]||(s[18]=[x("Contas a receber",-1)])]),_:1}),N(r,{to:"/despesas",class:"btn btn-ghost"},{default:C(()=>[...s[19]||(s[19]=[x("Despesas",-1)])]),_:1}),N(r,{to:"/fluxo-caixa",class:"btn btn-ghost"},{default:C(()=>[...s[20]||(s[20]=[x("Fluxo de caixa",-1)])]),_:1})]),e("div",Ne,[e("div",Ce,[s[21]||(s[21]=e("label",{for:"inicio"},"Inicio",-1)),p(e("input",{id:"inicio","onUpdate:modelValue":s[0]||(s[0]=t=>b.value.inicio=t),type:"date",class:"form-control"},null,512),[[m,b.value.inicio]])]),e("div",xe,[s[22]||(s[22]=e("label",{for:"fim"},"Fim",-1)),p(e("input",{id:"fim","onUpdate:modelValue":s[1]||(s[1]=t=>b.value.fim=t),type:"date",class:"form-control"},null,512),[[m,b.value.fim]])]),e("button",{class:"btn btn-primary btn-aplicar",type:"button",onClick:V},"Aplicar")])])]),e("div",Re,[e("article",Pe,[e("div",Ae,[s[23]||(s[23]=e("div",null,[e("p",{class:"eyebrow"},"Receitas"),e("h3",null,"Entradas por vencer")],-1)),e("span",Ue,o(O.value.length)+" itens",1)]),O.value.length?(n(),l("ul",Ee,[(n(!0),l(R,null,P(O.value,t=>(n(),l("li",{key:t.id},[e("div",null,[e("p",Fe,o(t.cliente||t.customer||"Receita"),1),e("p",Ie,"Vence em "+o(S(t.vencimento||t.data||t.dueDate)),1)]),e("div",Be,[e("span",Le,o(g(t.valor||t.value)),1),e("span",Me,o(G(t.vencimento||t.data||t.dueDate)),1)])]))),128))])):(n(),l("p",qe,"Nenhuma receita futura encontrada."))]),e("article",Oe,[e("div",je,[s[24]||(s[24]=e("div",null,[e("p",{class:"eyebrow"},"Despesas"),e("h3",null,"Saidas por vencer")],-1)),e("span",$e,o(j.value.length)+" itens",1)]),j.value.length?(n(),l("ul",Te,[(n(!0),l(R,null,P(j.value,t=>(n(),l("li",{key:t.id},[e("div",null,[e("p",ze,o(t.fornecedor||t.supplier||"Despesa"),1),e("p",He,"Vence em "+o(S(t.data||t.vencimento||t.dueDate)),1)]),e("div",Ge,[e("span",Je,o(g(t.valor||t.value)),1),e("span",Ke,o(G(t.data||t.vencimento||t.dueDate)),1)])]))),128))])):(n(),l("p",Qe,"Nenhuma despesa futura encontrada."))]),e("article",We,[e("div",Xe,[s[25]||(s[25]=e("div",null,[e("p",{class:"eyebrow"},"Atrasos"),e("h3",null,"Em atraso")],-1)),e("span",Ye,o(_.value.total)+" itens",1)]),e("div",Ze,[e("div",es,[e("p",ss,"Receitas ("+o(_.value.receitas.length)+")",1),_.value.receitas.length?(n(),l("ul",as,[(n(!0),l(R,null,P(_.value.receitas,t=>(n(),l("li",{key:`r-${t.id}`},[e("div",null,[e("p",ts,o(t.cliente||"Receita"),1),e("p",os,"Venceu em "+o(S(t.vencimento||t.dueDate)),1)]),e("div",ls,[e("span",ns,o(g(t.valor||t.value)),1),s[26]||(s[26]=e("span",{class:"tag danger"},"Atrasado",-1))])]))),128))])):(n(),l("p",is,"Sem receitas atrasadas."))]),e("div",rs,[e("p",ds,"Despesas ("+o(_.value.despesas.length)+")",1),_.value.despesas.length?(n(),l("ul",us,[(n(!0),l(R,null,P(_.value.despesas,t=>(n(),l("li",{key:`d-${t.id}`},[e("div",null,[e("p",cs,o(t.fornecedor||"Despesa"),1),e("p",vs,"Venceu em "+o(S(t.data||t.vencimento||t.dueDate)),1)]),e("div",ps,[e("span",ms,o(g(t.valor||t.value)),1),s[27]||(s[27]=e("span",{class:"tag danger"},"Atrasado",-1))])]))),128))])):(n(),l("p",fs,"Sem despesas atrasadas."))])])])]),e("div",{class:K(["modal",{show:E.value}]),onClick:A(y,["self"])},[e("div",_s,[e("div",bs,[e("div",{class:"modal-header"},[s[28]||(s[28]=e("h3",null,"Nova receita",-1)),e("button",{type:"button",class:"btn-close",onClick:y},"×")]),e("form",{onSubmit:A(ee,["prevent"])},[e("div",gs,[e("div",ys,[e("label",hs,[s[29]||(s[29]=e("span",null,"Descricao",-1)),p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>c.value.descricao=t),class:"form-control",required:""},null,512),[[m,c.value.descricao]])]),e("label",Ds,[s[30]||(s[30]=e("span",null,"Cliente",-1)),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>c.value.cliente=t),class:"form-control"},null,512),[[m,c.value.cliente]])]),e("label",ws,[s[31]||(s[31]=e("span",null,"Valor",-1)),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>c.value.valor=t),type:"number",min:"0",step:"0.01",class:"form-control",required:""},null,512),[[m,c.value.valor,void 0,{number:!0}]])]),e("label",ks,[s[32]||(s[32]=e("span",null,"Vencimento",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>c.value.vencimento=t),type:"date",class:"form-control",required:""},null,512),[[m,c.value.vencimento]])])]),I.value?(n(),l("p",Ss,o(I.value),1)):Q("",!0)]),e("div",Vs,[e("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancelar"),e("button",{type:"submit",class:"btn btn-success",disabled:k.value},"Salvar",8,Ns)])],32)])])],2),e("div",{class:K(["modal",{show:F.value}]),onClick:A(y,["self"])},[e("div",Cs,[e("div",xs,[e("div",{class:"modal-header"},[s[33]||(s[33]=e("h3",null,"Nova despesa",-1)),e("button",{type:"button",class:"btn-close",onClick:y},"×")]),e("form",{onSubmit:A(se,["prevent"])},[e("div",Rs,[e("div",Ps,[e("label",As,[s[34]||(s[34]=e("span",null,"Descricao",-1)),p(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>i.value.descricao=t),class:"form-control",required:""},null,512),[[m,i.value.descricao]])]),e("label",Us,[s[35]||(s[35]=e("span",null,"Fornecedor",-1)),p(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>i.value.fornecedor=t),class:"form-control"},null,512),[[m,i.value.fornecedor]])]),e("label",Es,[s[36]||(s[36]=e("span",null,"Valor",-1)),p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>i.value.valor=t),type:"number",min:"0",step:"0.01",class:"form-control",required:""},null,512),[[m,i.value.valor,void 0,{number:!0}]])]),e("label",Fs,[s[37]||(s[37]=e("span",null,"Data",-1)),p(e("input",{"onUpdate:modelValue":s[9]||(s[9]=t=>i.value.data=t),type:"date",class:"form-control",required:""},null,512),[[m,i.value.data]])]),e("label",Is,[s[39]||(s[39]=e("span",null,"Pago?",-1)),p(e("select",{"onUpdate:modelValue":s[10]||(s[10]=t=>i.value.pago=t),class:"form-control"},[...s[38]||(s[38]=[e("option",{value:!0},"Sim",-1),e("option",{value:!1},"Nao",-1)])],512),[[le,i.value.pago]])])]),B.value?(n(),l("p",Bs,o(B.value),1)):Q("",!0)]),e("div",Ls,[e("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancelar"),e("button",{type:"submit",class:"btn btn-warning",disabled:k.value},"Salvar",8,Ms)])],32)])])],2)])])}}},Ks=ae(qs,[["__scopeId","data-v-2f06553b"]]);export{Ks as default};
