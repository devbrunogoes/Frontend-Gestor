import{_ as S,r as s,x as T,o as D,Q as E,a as n,b as t,f as o,z as b,e as g,d as v,D as r,p as V,t as N,T as L,q,H as A}from"./index-CXM7zIvA.js";import{S as I}from"./SalesComposer-DG8Hcazj.js";import{a as M,b as O,d as R}from"./sales-BoYCHADK.js";import{g as $}from"./settings-CcoI3RDz.js";import{B as j,a as z}from"./BaseError-DaDu2INT.js";/* empty css                                                                  */const H={class:"content-area sales-view"},Q={key:2,class:"sales-layout"},U={key:0,class:"intro-hint"},F={key:0,class:"feedback-banner"},G={class:"sales-help"},J={__name:"VendasView",setup(K){const y=s([]),k=s([]),P=s([]),p=s(!1),i=s(""),c=T({origem:"sistema",formaPagamento:"Dinheiro",statusPagamento:"Pago"}),u=s(!1),d=s(""),x=s(null);let m=null;function f(){m&&(clearTimeout(m),m=null),d.value=""}function h(){u.value=!0,A(()=>{var e;(e=x.value)==null||e.scrollIntoView({behavior:"smooth",block:"start"})})}function C(e){f();const a=(e==null?void 0:e.total)??0,l=(e==null?void 0:e.metodo)??"Pagamento",B=a>0?` · ${a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}`:"";d.value=`Venda registrada (${l})${B}`,m=setTimeout(()=>{f()},4e3)}async function _(){p.value=!0,i.value="";try{const[e,a,l]=await Promise.all([M(),O(),R()]);y.value=e,k.value=a,P.value=l}catch(e){i.value=(e==null?void 0:e.message)||"Erro ao carregar dados de apoio."}finally{p.value=!1}}async function w(){try{const e=await $();c.origem=(e==null?void 0:e.vendaOrigemPadrao)||"sistema",c.formaPagamento=(e==null?void 0:e.formaPagamentoPadrao)||"Pix",c.statusPagamento=(e==null?void 0:e.statusPagamentoPadrao)||"Pago"}catch(e){console.warn("Não foi possível carregar configurações de venda:",e)}}return D(async()=>{await Promise.all([_(),w()]),u.value=!0}),E(()=>{f()}),(e,a)=>{const l=q("router-link");return t(),n("section",H,[o("header",{class:"page-header"},[a[0]||(a[0]=o("div",{class:"page-title"},[o("h2",null,"Vendas"),o("p",null,"Crie vendas em segundos com atalhos de pagamento integrados ao formulário.")],-1)),o("button",{type:"button",class:"btn btn-primary",onClick:h}," Vendas ")]),i.value?(t(),b(j,{key:0,message:i.value,retry:_},null,8,["message"])):p.value?(t(),b(z,{key:1,message:"Carregando dados…"})):(t(),n("div",Q,[u.value?g("",!0):(t(),n("p",U,[...a[1]||(a[1]=[r(" Toque em ",-1),o("strong",null,"Vendas",-1),r(" para abrir o formulário e usar os atalhos de Pix, Cartão ou Dinheiro. ",-1)])])),v(L,{name:"fade-slide"},{default:V(()=>[u.value?(t(),n("div",{key:0,ref_key:"composerAnchor",ref:x,class:"composer-wrapper"},[d.value?(t(),n("div",F,N(d.value),1)):g("",!0),v(I,{clients:y.value,execucoes:k.value,catalogo:P.value,defaults:c,onSaved:C},null,8,["clients","execucoes","catalogo","defaults"])],512)):g("",!0)]),_:1}),o("section",G,[a[5]||(a[5]=o("h4",null,"Dicas rápidas",-1)),o("p",null,[a[3]||(a[3]=r("Os relatórios completos continuam disponíveis em ",-1)),v(l,{to:"/relatorios/vendas"},{default:V(()=>[...a[2]||(a[2]=[r("Relatórios > Vendas",-1)])]),_:1}),a[4]||(a[4]=r(".",-1))]),a[6]||(a[6]=o("ul",null,[o("li",null,"Os botões Pix, Cartão e Dinheiro ficam dentro do formulário e trocam a forma de pagamento com um toque."),o("li",null,"Selecione clientes cadastrados ou informe um nome rápido sem sair da tela."),o("li",null,"Itens podem ser carregados do catálogo e ajustados rapidamente para uso no celular.")],-1))])]))])}}},oe=S(J,[["__scopeId","data-v-e2578479"]]);export{oe as default};
