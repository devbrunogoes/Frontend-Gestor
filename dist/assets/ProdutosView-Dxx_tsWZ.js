import{_ as J,r as d,z as K,o as O,a as i,b as l,f as e,e as u,B as M,t as n,F as H,g as W,w as z,n as c,m as v,v as f}from"./index-IzLOKglm.js";import{l as X,d as Y,u as Z,a as tt}from"./products-B2sxqzwZ.js";import{B as et,a as st}from"./BaseError-DNv4Myx8.js";/* empty css                                                                  */const ot={class:"content-area products-view"},at={key:0,class:"summary-row"},lt={class:"summary-card"},it={class:"value"},nt={class:"summary-card"},rt={class:"value"},dt={key:3,class:"products-area"},ut={key:0,class:"empty-state"},ct={key:1,class:"products-grid"},mt={class:"product-card-header"},pt={class:"product-overview"},vt=["src","alt"],ft={key:1,class:"fa-solid fa-image","aria-hidden":"true"},gt={class:"product-texts"},bt={class:"product-title-row"},yt={class:"code-chip"},kt={class:"product-meta-row"},Ct={class:"meta-pill"},_t={key:0,class:"meta-pill"},wt={key:1,class:"meta-pill light"},St={key:0,class:"product-description"},Nt={class:"product-card-actions"},Pt={class:"action-buttons"},Dt=["onClick"],It=["onClick"],Qt={class:"product-card-body"},qt={class:"product-stat"},ht={class:"product-stat"},xt={class:"stat-stack"},Et={key:0,class:"cell-muted"},Vt={class:"product-stat"},Bt={class:"modal-dialog"},Mt={class:"modal-content"},zt={class:"modal-header"},Ft={id:"produtoModalLabel"},Tt={class:"modal-body"},Ut={class:"form-grid"},Lt={class:"form-group span-4 image-upload"},At={class:"image-picker"},Rt=["src"],$t={key:1,class:"fa-solid fa-image","aria-hidden":"true"},Gt={class:"image-actions"},jt={class:"form-group span-4"},Jt={class:"form-group span-8"},Kt={class:"form-group form-group-large"},Ot={class:"form-group span-3"},Ht={class:"form-group span-3"},Wt={class:"form-group span-3"},Xt={class:"form-group span-3"},Yt={class:"form-group span-3 active-field"},Zt={class:"status-toggle"},te={key:0,class:"alert alert-error"},ee={key:1,class:"alert alert-success"},se={__name:"ProdutosView",setup(oe){const b=d([]),S=d(!1),y=d(""),N=d(!1),k=d(null),s=K({code:"",name:"",description:"",price:0,cost:0,stockQuantity:0,minStock:0,active:!0,imageData:null,imageContentType:null}),r=d(""),g=d(""),m=d(""),p=d(null),F=a=>{const t=Number((a==null?void 0:a.stockQuantity)??0),o=Number((a==null?void 0:a.minStock)??0);return t<=0?"stock-empty":o>0&&t<=o?"stock-low":"stock-ok"};function T(a){return Number(a||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function h(){s.code="",s.name="",s.description="",s.price=0,s.cost=0,s.stockQuantity=0,s.minStock=0,s.active=!0,s.imageData=null,s.imageContentType=null,m.value="",E(),k.value=null,r.value="",g.value=""}function x(){h(),N.value=!0}function U(a){k.value=a.id,s.code=a.code||"",s.name=a.name||"",s.description=a.description||"",s.price=Number(a.price||0),s.cost=Number(a.cost||0),s.stockQuantity=Number(a.stockQuantity||0),s.minStock=Number(a.minStock||0),s.active=!!a.active,s.imageData=a.imageData||null,s.imageContentType=a.imageContentType||null,m.value=I(a),r.value="",g.value="",N.value=!0}function P(){N.value=!1}async function D(){S.value=!0,y.value="";try{b.value=await X()}catch(a){y.value=(a==null?void 0:a.message)||"Erro ao carregar produtos"}finally{S.value=!1}}async function L(){if(r.value="",g.value="",!s.code||!s.name){r.value="Código e Nome são obrigatórios.";return}const a={code:s.code,name:s.name,description:s.description,price:Number(s.price||0),cost:Number(s.cost||0),stockQuantity:Number(s.stockQuantity||0),minStock:Number(s.minStock||0),active:!!s.active,imageData:s.imageData,imageContentType:s.imageContentType};try{k.value?await Z(k.value,a):await tt(a),g.value="Produto salvo.",P(),h(),await D()}catch(t){r.value=(t==null?void 0:t.message)||"Erro ao salvar"}}async function A(a){if(confirm("Confirma excluir o produto #"+a.id+"?"))try{await Y(a.id),await D()}catch(t){r.value=(t==null?void 0:t.message)||"Erro ao excluir"}}O(async()=>{await D()});function I(a){return!a||!a.imageData?"":`data:${a.imageContentType||"image/png"};base64,${a.imageData}`}function R(a){var _;const t=(a==null?void 0:a.target)||p.value,o=(_=t==null?void 0:t.files)==null?void 0:_[0];if(!o)return;if(o.size>2*1024*1024){r.value="A imagem deve ter no máximo 2MB.",t&&(t.value="");return}const C=new FileReader;C.onload=Q=>{var B;const w=(B=Q.target)==null?void 0:B.result;if(typeof w!="string")return;const[j,V]=w.split(",");if(!V)return;const q=j.match(/data:(.*);base64/);s.imageData=V,s.imageContentType=(q==null?void 0:q[1])||o.type||"image/png",m.value=w,r.value="",p.value&&(p.value.value="")},C.readAsDataURL(o)}function $(){s.imageData=null,s.imageContentType=null,m.value="",E()}function E(){p.value&&(p.value.value="")}function G(){var a,t;r.value="",(t=(a=p.value)==null?void 0:a.click)==null||t.call(a)}return(a,t)=>(l(),i("section",ot,[e("header",{class:"page-header products-header"},[t[10]||(t[10]=e("div",{class:"header-copy"},[e("h2",null,"Produtos"),e("p",null,"Gerencie catálogo, estoque e fornecedores com rapidez e clareza.")],-1)),e("button",{class:"btn btn-primary header-action",type:"button",onClick:x},[...t[9]||(t[9]=[e("i",{class:"fa-solid fa-box-open"},null,-1),e("span",null,"Novo produto",-1)])])]),!S.value&&!y.value?(l(),i("div",at,[e("div",lt,[t[11]||(t[11]=e("span",{class:"label"},"Produtos cadastrados",-1)),e("strong",it,n(b.value.length),1)]),e("div",nt,[t[12]||(t[12]=e("span",{class:"label"},"Itens ativos",-1)),e("strong",rt,n(b.value.filter(o=>o.active!==!1).length),1)]),t[13]||(t[13]=e("div",{class:"summary-card hint"}," Mantenha estoque mínimo atualizado para evitar rupturas nas vendas. ",-1))])):u("",!0),y.value?(l(),M(et,{key:1,message:y.value,retry:D},null,8,["message"])):S.value?(l(),M(st,{key:2,message:"Carregando produtos…"})):(l(),i("div",dt,[b.value.length?(l(),i("div",ct,[(l(!0),i(H,null,W(b.value,o=>{var C,_,Q;return l(),i("article",{key:o.id,class:c(["product-card",{"is-inactive":o.active===!1}])},[e("div",mt,[e("div",pt,[e("div",{class:c(["product-thumb",{"has-image":I(o)}])},[I(o)?(l(),i("img",{key:0,src:I(o),alt:o.name||"Imagem do produto"},null,8,vt)):(l(),i("i",ft))],2),e("div",gt,[e("div",bt,[e("h3",null,n(o.name||"Produto sem nome"),1),e("span",yt,n(o.code||"Sem código"),1)]),e("div",kt,[e("span",Ct,"#"+n(o.id),1),(C=o.category)!=null&&C.name?(l(),i("span",_t,n(o.category.name),1)):u("",!0),(_=o.supplier)!=null&&_.name?(l(),i("span",wt,n(o.supplier.name),1)):u("",!0)]),o.description?(l(),i("p",St,n(o.description),1)):u("",!0)])]),e("div",Nt,[e("span",{class:c(["status-pill",o.active!==!1?"status-active":"status-inactive"])},n(o.active!==!1?"Ativo":"Inativo"),3),e("div",Pt,[e("button",{class:"btn-icon",type:"button",onClick:w=>U(o),title:"Editar produto"},[...t[18]||(t[18]=[e("i",{class:"fa-solid fa-pen"},null,-1)])],8,Dt),e("button",{class:"btn-icon danger",type:"button",onClick:w=>A(o),title:"Excluir produto"},[...t[19]||(t[19]=[e("i",{class:"fa-solid fa-trash"},null,-1)])],8,It)])])]),e("div",Qt,[e("div",qt,[t[20]||(t[20]=e("span",{class:"label"},"Preço",-1)),e("strong",null,n(T(o.price)),1)]),e("div",ht,[t[21]||(t[21]=e("span",{class:"label"},"Estoque",-1)),e("div",xt,[e("span",{class:c(["stock-pill",F(o)])},n(o.stockQuantity??0),3),o.minStock?(l(),i("small",Et,"mín. "+n(o.minStock),1)):u("",!0)])]),e("div",Vt,[t[22]||(t[22]=e("span",{class:"label"},"Fornecedor",-1)),e("strong",null,n(((Q=o.supplier)==null?void 0:Q.name)||"—"),1)])])],2)}),128))])):(l(),i("div",ut,[t[15]||(t[15]=e("i",{class:"fa-solid fa-box"},null,-1)),t[16]||(t[16]=e("h3",null,"Comece adicionando seus produtos",-1)),t[17]||(t[17]=e("p",null,"Cadastre códigos e preços para abastecer as telas de venda e estoque.",-1)),e("button",{class:"btn btn-primary",type:"button",onClick:x},[...t[14]||(t[14]=[e("i",{class:"fa-solid fa-plus"},null,-1),e("span",null,"Adicionar primeiro produto",-1)])])]))])),e("div",{class:c(["modal",{show:N.value}]),role:"dialog","aria-labelledby":"produtoModalLabel","aria-hidden":"true",onClick:z(P,["self"])},[e("div",Bt,[e("div",Mt,[e("div",zt,[e("div",null,[e("h3",Ft,n(k.value?"Editar produto":"Novo produto"),1),t[23]||(t[23]=e("p",{class:"modal-subtitle"},"Organize código, preço e estoque para manter o catálogo consistente.",-1))]),e("button",{type:"button",class:"btn-close",onClick:P,"aria-label":"Fechar"},[...t[24]||(t[24]=[e("i",{class:"fa-solid fa-times"},null,-1)])])]),e("form",{onSubmit:z(L,["prevent"])},[e("div",Tt,[e("div",Ut,[e("div",Lt,[t[27]||(t[27]=e("label",null,"Imagem",-1)),e("div",At,[e("div",{class:c(["image-preview",{"has-image":m.value}])},[m.value?(l(),i("img",{key:0,src:m.value,alt:"Pré-visualização do produto"},null,8,Rt)):(l(),i("i",$t))],2),e("div",Gt,[e("button",{type:"button",class:"btn btn-outline",onClick:G},[...t[25]||(t[25]=[e("i",{class:"fa-solid fa-upload"},null,-1),e("span",null,"Selecionar imagem",-1)])]),s.imageData?(l(),i("button",{key:0,type:"button",class:"btn btn-link",onClick:$},"Remover imagem")):u("",!0),t[26]||(t[26]=e("small",{class:"field-hint"},"Formatos JPG ou PNG até 2MB.",-1))])]),e("input",{ref_key:"imageFileInput",ref:p,type:"file",accept:"image/*",class:"sr-only",onChange:R},null,544)]),e("div",jt,[t[28]||(t[28]=e("label",{for:"code"},"Código",-1)),v(e("input",{id:"code",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=o=>s.code=o),required:"",placeholder:"SKU ou referência interna"},null,512),[[f,s.code,void 0,{trim:!0}]]),t[29]||(t[29]=e("small",{class:"field-hint"},"Use o identificador que sua equipe já utiliza no dia a dia.",-1))]),e("div",Jt,[t[30]||(t[30]=e("label",{for:"name"},"Nome",-1)),v(e("input",{id:"name",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),required:"",placeholder:"Nome comercial do produto"},null,512),[[f,s.name,void 0,{trim:!0}]]),t[31]||(t[31]=e("small",{class:"field-hint"},"Este nome aparece nas telas de venda, estoque e relatórios.",-1))]),e("div",Kt,[t[32]||(t[32]=e("label",{for:"description"},"Descrição",-1)),v(e("textarea",{id:"description",class:"form-control",rows:"3","onUpdate:modelValue":t[2]||(t[2]=o=>s.description=o),placeholder:"Detalhes importantes para a equipe ou vendedor"},null,512),[[f,s.description,void 0,{trim:!0}]]),t[33]||(t[33]=e("small",{class:"field-hint"},"Inclua observações para orientar a venda ou reposição.",-1))]),e("div",Ot,[t[34]||(t[34]=e("label",{for:"price"},"Preço",-1)),v(e("input",{id:"price",type:"number",min:"0",step:"0.01",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=o=>s.price=o),placeholder:"0,00"},null,512),[[f,s.price,void 0,{number:!0}]]),t[35]||(t[35]=e("small",{class:"field-hint"},"Valor de venda exibido em Vendas e Relatórios.",-1))]),e("div",Ht,[t[36]||(t[36]=e("label",{for:"cost"},"Custo",-1)),v(e("input",{id:"cost",type:"number",min:"0",step:"0.01",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.cost=o),placeholder:"0,00"},null,512),[[f,s.cost,void 0,{number:!0}]]),t[37]||(t[37]=e("small",{class:"field-hint"},"Ajuda a calcular margem e controlar gastos.",-1))]),e("div",Wt,[t[38]||(t[38]=e("label",{for:"stockQuantity"},"Qtd. Estoque",-1)),v(e("input",{id:"stockQuantity",type:"number",min:"0",step:"1",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.stockQuantity=o),placeholder:"0"},null,512),[[f,s.stockQuantity,void 0,{number:!0}]]),t[39]||(t[39]=e("small",{class:"field-hint"},"Quantidade disponível para venda imediata.",-1))]),e("div",Xt,[t[40]||(t[40]=e("label",{for:"minStock"},"Estoque Mín.",-1)),v(e("input",{id:"minStock",type:"number",min:"0",step:"1",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=o=>s.minStock=o),placeholder:"0"},null,512),[[f,s.minStock,void 0,{number:!0}]]),t[41]||(t[41]=e("small",{class:"field-hint"},"Quando atingido, sinaliza necessidade de reposição.",-1))]),e("div",Yt,[t[44]||(t[44]=e("label",null,"Status",-1)),e("div",Zt,[e("button",{type:"button",class:c(["toggle-pill",s.active?"is-active":""]),onClick:t[7]||(t[7]=o=>s.active=!0)},[...t[42]||(t[42]=[e("i",{class:"fa-solid fa-check"},null,-1),e("span",null,"Ativo",-1)])],2),e("button",{type:"button",class:c(["toggle-pill",s.active?"":"is-active"]),onClick:t[8]||(t[8]=o=>s.active=!1)},[...t[43]||(t[43]=[e("i",{class:"fa-solid fa-pause"},null,-1),e("span",null,"Inativo",-1)])],2)]),t[45]||(t[45]=e("small",{class:"field-hint"},"Produtos inativos não aparecem nas telas operacionais.",-1))]),e("div",{class:"form-actions"},[e("button",{type:"button",class:"btn btn-secondary",onClick:P},"Cancelar"),t[46]||(t[46]=e("button",{type:"submit",class:"btn btn-success"},"Salvar produto",-1))])]),r.value?(l(),i("div",te,n(r.value),1)):u("",!0),g.value?(l(),i("div",ee,n(g.value),1)):u("",!0)])],32)])])],2)]))}},re=J(se,[["__scopeId","data-v-2a12b7df"]]);export{re as default};
